<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Recomendaciones Culturales</title>

  <!-- Favicon -->
  <link rel="icon" href="./static/favicon.ico" type="image/x-icon">

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <style>
    body {
      background-color: #2d3748;
      color: #f7fafc;
    }

    .card {
      background-color: #ffffff;
      border-radius: 15px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
      padding: 2rem;
      margin: 1rem 0;
    }

    .emoji {
      font-size: 1.5rem;
      margin-left: 10px;
    }

    .logo {
      width: 180px;
      margin-top: 20px;
      margin-bottom: 30px;
      border-radius: 20px;
      border: 4px solid #ff7f00; /* Bordes naranjas */
      padding: 10px;
      box-shadow: 0 8px 15px rgba(255, 127, 0, 0.3);
    }

     .card-title {
          font-size: 1.5rem;
          font-weight: 700;
          color: #2b2d42;
     }

     .recommendation-item {
     display: flex;
     flex-direction: row;  /* Las cards serÃ¡n horizontales */
     background-color: #ffffff;
     padding: 20px;
     border-radius: 12px;
     box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
     justify-content: flex-start; /* AlineaciÃ³n al principio */
     gap: 1rem;  /* Espacio entre el tÃ­tulo y la descripciÃ³n */
     }

    .button-submit {
      background-color: #ff7f00;
      color: white;
      padding: 12px 24px;
      border-radius: 8px;
      font-weight: bold;
      text-transform: uppercase;
      transition: background-color 0.3s ease;
      width: 100%;
      margin-top: 1rem;
    }

    .button-submit:hover {
      background-color: #ff5722;
    }

    /* Contenedor de recomendaciones */
     .recommendation-container {
     display: flex;
     flex-direction: column;  /* Alinea las cards una debajo de otra */
     gap: 1.5rem;  /* Espaciado entre las cards */
     margin-top: 2rem;
     }

    .recommendation-card {
      background-color: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .recommendation-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: #ff5722;
      margin-bottom: 10px;
      text-align: center;
    }

    .recommendation-description {
      font-size: 1rem;
      color: #4a5568;
      line-height: 1.6;
      text-align: justify;
    }
  </style>
</head>

<body class="font-sans text-gray-900">

  <div class="max-w-3xl mx-auto p-6">
    <!-- Logo -->
    <div class="text-center">
      <img src="./static/logo.png" alt="Logo" class="logo mx-auto">
    </div>

    <!-- TÃ­tulo principal -->
    <h1 class="text-5xl font-bold text-center text-orange-500 mb-8">Recomendaciones Culturales ğŸ§ğŸ“š</h1>

    <!-- Formulario de recomendaciÃ³n -->
    <div class="card">
      <h2 class="text-3xl font-semibold text-gray-800 mb-4">Â¡Solicita tu recomendaciÃ³n cultural! ğŸ‰</h2>
      <form id="recommendation-form">
        <!-- Tipo de contenido -->
        <div class="mb-6">
          <label for="tipo" class="block text-gray-700">Tipo de contenido</label>
          <select id="tipo" name="tipo" class="w-full p-3 border border-gray-300 rounded-md mt-2 focus:ring-orange-500">
            <option value="libro">ğŸ“– Libro</option>
            <option value="pelÃ­cula">ğŸ¬ PelÃ­cula</option>
            <option value="videojuego">ğŸ® Videojuego</option>
            <option value="juego de mesa">ğŸ² Juego de Mesa</option>
            <option value="podcast">ğŸ™ï¸ Podcast</option>
          </select>
        </div>

        <!-- Edad recomendada -->
        <div class="mb-6">
          <label for="edad" class="block text-gray-700">Edad recomendada</label>
          <select id="edad" name="edad" class="w-full p-3 border border-gray-300 rounded-md mt-2 focus:ring-orange-500">
            <option value="infantil">ğŸ‘¶ Infantil</option>
            <option value="juvenil">ğŸ§‘â€ğŸ¤ Juvenil</option>
            <option value="adulto">ğŸ‘©â€ğŸ¦³ Adulto</option>
          </select>
        </div>

        <!-- GÃ©nero -->
        <div class="mb-6">
          <label for="genero" class="block text-gray-700">GÃ©nero</label>
          <select id="genero" name="genero" class="w-full p-3 border border-gray-300 rounded-md mt-2 focus:ring-orange-500">
            <option value="ciencia ficciÃ³n">ğŸš€ Ciencia FicciÃ³n</option>
            <option value="comedia">ğŸ˜‚ Comedia</option>
            <option value="drama">ğŸ­ Drama</option>
            <option value="romance">ğŸ’– Romance</option>
            <option value="fantasÃ­a">ğŸ§šâ€â™€ï¸ FantasÃ­a</option>
            <option value="acciÃ³n">ğŸ’¥ AcciÃ³n</option>
            <option value="terror">ğŸ‘» Terror</option>
            <option value="guerra">âš”ï¸ Guerra</option>
            <option value="lucha">ğŸ¥Š Lucha</option>
          </select>
        </div>

        <!-- Cantidad de recomendaciones -->
        <div class="mb-6">
          <label for="cantidad" class="block text-gray-700">Cantidad de recomendaciones</label>
          <input type="number" id="cantidad" name="cantidad" min="1" value="5" class="w-full p-3 border border-gray-300 rounded-md mt-2 focus:ring-orange-500" />
        </div>

        <div class="text-center">
          <button type="submit" class="button-submit">Obtener Recomendaciones</button>
        </div>
      </form>
    </div>

    <!-- SecciÃ³n de recomendaciones -->
    <div id="recommendations" class="recommendation-container">
          <!-- Las recomendaciones se aÃ±adirÃ¡n aquÃ­ dinÃ¡micamente -->
    </div>

  </div>

  <script>
// Manejador del formulario
$("#recommendation-form").on("submit", function (e) {
  e.preventDefault();

  // Captura los datos del formulario
  const tipo = $("#tipo").val();
  const edad = $("#edad").val();
  const genero = $("#genero").val();
  const cantidad = $("#cantidad").val();

  // Llamada a la API para obtener recomendaciones
  $.ajax({
    url: 'http://localhost:8000/get_recommendations',
    type: 'POST',
    contentType: 'application/json',
    data: JSON.stringify({
      tipo: tipo,
      edad: edad,
      genero: genero,
      cantidad: parseInt(cantidad)
    }),
    success: function (response) {
      // Mostrar la respuesta completa para depuraciÃ³n
      console.log(response);

      // Muestra las recomendaciones
      const recommendationsContainer = $("#recommendations");
      recommendationsContainer.empty(); // Limpiar cualquier recomendaciÃ³n anterior

      // Usamos una expresiÃ³n regular para separar correctamente las recomendaciones
      // Separa las recomendaciones por los saltos de lÃ­nea dobles
      const recommendations = response.result.split(/\n\n/);

      recommendations.forEach((recommendation) => {
        // Separar tÃ­tulo y descripciÃ³n
        const parts = recommendation.split('\n');  // Separar tÃ­tulo de la descripciÃ³n por salto de lÃ­nea
        const title = parts[0].replace('TÃ­tulo: ', '').trim();  // TÃ­tulo de la recomendaciÃ³n
        const description = parts[1].replace('DescripciÃ³n: ', '').trim();  // DescripciÃ³n de la recomendaciÃ³n

        // Crear el HTML para la recomendaciÃ³n
        const recommendationHtml = `
          <div class="recommendation-item bg-white p-6 rounded-lg shadow-lg hover:bg-orange-100 transition-all duration-300">
            <div class="recommendation-title text-2xl font-semibold text-orange-600 mb-3">
              ${title}
            </div>
            <div class="recommendation-description text-gray-600">
              <p>${description}</p>
            </div>
          </div>
        `;
        recommendationsContainer.append(recommendationHtml);
      });
    },
    error: function () {
      alert('Â¡ERROR! La cantidad mÃ¡xima de recomendaciones es 6');
    }
  });
});
  </script>

</body>

</html>
